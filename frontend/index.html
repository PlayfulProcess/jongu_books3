<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JonguBooks - Story Creation for Mindful Parents</title>
  <link rel="stylesheet" href="css/styles.css">
</head>
<body>
  <!-- Mobile Menu Button -->
  <button class="mobile-menu-button" onclick="toggleSidebar()">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M3 12h18M3 6h18M3 18h18"></path>
    </svg>
  </button>

  <!-- Enhanced Sidebar -->
  <div class="sidebar" id="sidebar">
    <div class="logo">
      <h1><span class="sparkle">📖</span> JonguBooks</h1>
      <p>Stories that shape souls.</p>
    </div>

    <div class="nav-section">
      <div class="nav-title">Create</div>
      <a href="#story-section" class="nav-item active" onclick="setActiveSection(event, 'story')">
        <span class="step-circle">1</span> Story Foundation
      </a>
      <a href="#characters-section" class="nav-item" onclick="setActiveSection(event, 'characters')">
        <span class="step-circle">2</span> Characters
      </a>
      <a href="#pages-section" class="nav-item" onclick="setActiveSection(event, 'pages')">
        <span class="step-circle">3</span> Pages & Layout
      </a>
      <a href="#export-section" class="nav-item" onclick="setActiveSection(event, 'export')">
        <span class="step-circle">4</span> Review & Export
      </a>
    </div>

    <div class="nav-section">
      <div class="nav-title">Tools</div>
      <a href="#" class="nav-item" onclick="startOver(event)">
        <span>🔄</span> Start Over
      </a>
    </div>

    <button class="upgrade-cta" onclick="window.open('https://www.playfulprocess.com/', '_blank')">✨ Upgrade to AI-Powered</button>
  </div>

  <main class="main-content">
    <datalist id="character-types">
      <option value="Young child (learning and growing)"></option>
      <option value="Wise guide (mentor figure)"></option>
      <option value="Animal friend (playful companion)"></option>
      <option value="Magical being (wonder-bringer)"></option>
      <option value="Parent/adult (nurturing figure)"></option>
    </datalist>

    <!-- Progress Bar -->
    <div class="progress-bar">
      <div class="progress-bar-title">Your Story Journey</div>
      <div class="progress-steps">
        <div class="progress-line">
          <div class="progress-line-fill" id="progressFill"></div>
        </div>
        <div class="progress-step active" data-step="story">
          <div class="progress-step-circle">1</div>
          <div class="progress-step-label">Story</div>
        </div>
        <div class="progress-step" data-step="characters">
          <div class="progress-step-circle">2</div>
          <div class="progress-step-label">Characters</div>
        </div>
        <div class="progress-step" data-step="pages">
          <div class="progress-step-circle">3</div>
          <div class="progress-step-label">Pages & Art</div>
        </div>
        <div class="progress-step" data-step="export">
          <div class="progress-step-circle">4</div>
          <div class="progress-step-label">Review & Export</div>
        </div>
      </div>
    </div>

    <!-- Enhanced Header -->
    <header class="header">
      <h1>Create Your Own Children's Story</h1>
      <p class="text-lg text-gray-600 leading-relaxed">
        My <em><strong>PlayfulProcess</strong></em> journey into parenthood invites me to explore new ways of educating my children through stories. In a world where AI makes creation more accessible than ever, I've discovered something profound: <strong>it's often easier to build the exact story my child needs than to search for the perfect book that may not exist.</strong>
      </p>
      
      <div class="gift-callout">
        <p class="intro-text" style="margin-bottom: 1rem;">
          <strong>How it works:</strong> Free users can use our custom GPT+ assistant (link below) to generate story content, then paste it back here to create beautiful books. Paid members get instant AI generation directly within JonguBooks.
        </p>
        <p style="color: #718096; font-size: 0.95rem; margin-top: 1rem;">
          <strong>Not into AI? I get it!</strong> Some days I wake up feeling the same way. JonguBooks works beautifully as a pure creative tool - write your own stories, draw your own illustrations, or use photos. The AI is just an option, not a requirement. Your imagination is the only tool you truly need. 💚
        </p>
        <p style="color: #b7791f; font-size: 0.95rem; margin-top: 1rem;">
          <strong>Note:</strong> AI generation (especially with full story context) can sometimes take a while. Please be patient while the magic happens!
        </p>
        <div class="button-group" style="justify-content: center; margin-top: 1.5rem;">
          <button class="button" onclick="window.open('https://chatgpt.com/g/g-68582fc3c3f481919db280da20d31639-jongubooks-assistant', '_blank')">
            🤖 Open JonguBooks GPT+ (Free)
          </button>
          <button class="button button-secondary" onclick="window.open('https://www.playfulprocess.com/', '_blank')">
            ✨ Upgrade for Integrated AI
          </button>
        </div>
      </div>
    </header>

    <!-- Step 1: Story Foundation -->
    <section id="story-section" class="section">
      <div class="section-header">
        <div class="step-number">1</div>
        <h2 class="section-title">Build Your Story Foundation</h2>
      </div>
      <div class="field-group">
        <label class="field-label">Story Title</label>
        <input type="text" class="field-input" placeholder="Give your story a memorable title" id="storyTitle">
      </div>
      <div class="field-group">
        <label class="field-label">Core Message or Life Lesson</label>
        <textarea class="field-input field-textarea" placeholder="What do you want your child to learn or feel?" id="coreMessage"></textarea>
      </div>
      <div class="field-group">
        <label class="field-label">Story Outline</label>
        <textarea class="field-input field-textarea" style="min-height: 200px;" placeholder="Write or paste your story outline here..." id="storyOutline"></textarea>
      </div>
      <div class="form-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
        <div class="field-group">
          <label class="field-label">Total Words (Optional)</label>
          <input type="number" class="field-input" placeholder="e.g., 500" id="totalWords">
        </div>
        <div class="field-group">
          <label class="field-label">Number of Pages (Optional)</label>
          <input type="number" class="field-input" placeholder="e.g., 12" id="totalPages">
        </div>
      </div>
      <div class="form-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
        <div class="field-group">
          <label class="field-label">Story Tone</label>
          <select class="field-input" id="storyTone">
            <option>Gentle & Nurturing</option>
            <option>Adventurous & Brave</option>
            <option>Joyful & Playful</option>
            <option>Wise & Teaching</option>
          </select>
        </div>
        <div class="field-group">
          <label class="field-label">Target Age</label>
          <select class="field-input" id="targetAge">
            <option>2-4 years</option>
            <option>4-6 years</option>
            <option>6-8 years</option>
            <option>8-12 years</option>
          </select>
        </div>
      </div>
      <div class="button-group" style="margin-bottom: 2rem;">
        <button class="button" onclick="completeStoryFoundation(event)">
          🤖 Use AI to Complete Story Foundation
        </button>
      </div>
    </section>

    <!-- Step 2: Characters -->
    <section id="characters-section" class="section">
      <div class="section-header">
        <div class="step-number">2</div>
        <h2 class="section-title">Define Your Characters</h2>
      </div>
      <div class="button-group">
        <button class="button" onclick="generateCharacters(event)">
          🤖 Use AI to Create Characters
        </button>
      </div>
      <div id="charactersContainer">
        <!-- Character cards will be dynamically added here -->
      </div>
      <button class="add-button" onclick="addCharacter()">+ Add Another Character</button>
    </section>

    <!-- Step 3: Pages & Layout -->
    <section id="pages-section" class="section">
      <div class="section-header">
        <div class="step-number">3</div>
        <h2 class="section-title">Design Your Pages</h2>
      </div>
       <div class="button-group" style="margin-bottom: 2rem;">
        <button class="button" onclick="generatePages(event)">
          🤖 Use AI to Create All Pages
        </button>
        <button class="button button-secondary" onclick="recreateAllImages(event)">
          🎨 Recreate All Images
        </button>
      </div>
      <div id="pagesContainer">
        <!-- Page containers will be dynamically added here -->
      </div>
      <button class="add-button" onclick="addPage()">+ Add New Page</button>
    </section>

    <!-- Step 4: Review & Export -->
    <section id="export-section" class="section">
      <div class="section-header">
        <div class="step-number">4</div>
        <h2 class="section-title">Review & Export</h2>
      </div>
      <p class="section-description">
        Preview your story and export it in your preferred format.
      </p>
      <div style="margin: 2rem 0; padding: 1.5rem; background: #f9fafb; border-radius: 12px; border: 1px solid #e2e8f0; text-align: center;">
        <strong>To save your work:</strong> Use the <b>Preview Book</b> button below, then print the preview page as a PDF using your browser's print dialog.<br><br>
        <span style="color: #805ad5;">We are working on better saving and export capabilities soon!</span>
      </div>
      <div class="button-group" style="justify-content: center; margin-top: 2rem;">
        <button class="button" onclick="previewBook()">👁️ Preview Book</button>
        <button class="button button-secondary" onclick="startNewStory()">📖 Create Another Story</button>
      </div>
    </section>
  </main>

  <!-- AI Chat Assistant -->
  <div id="ai-chat-popup" class="ai-chat-popup">
    <div class="ai-chat-header">
      <h3>JonguBooks Assistant</h3>
      <button id="close-chat-btn">&times;</button>
    </div>
    <div class="ai-chat-messages" id="ai-chat-messages">
      <div class="message assistant">Hello! I'm your creative partner. Ask me for story ideas, character names, or anything else you need to build a wonderful book.</div>
    </div>
    <div class="ai-chat-input-container">
      <input type="text" id="ai-chat-input" placeholder="e.g., 'Suggest a story about sharing'">
      <button id="ai-chat-send-btn">➤</button>
    </div>
  </div>

  <button id="open-chat-btn" class="open-chat-btn">🤖</button>

  <!-- Toast Notification -->
  <div id="toast" class="toast">
    <span id="toastMessage">Message here</span>
  </div>

  <script src="app.js"></script>
</body>
</html>